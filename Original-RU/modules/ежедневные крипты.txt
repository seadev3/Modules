Регламент ежедневной подготовки криптов

1. Разработчик готовит утренний билд следующим образом:
- версии всех файлов увеличиваются, чтобы они отличались от версий вчерашних файлов
- нужно убедиться в том что прокладки рабочие.
Билд не выдается только если нету живых прокладок совсем. Это считается исключительной ситуацией, ставим всех на уши.
Если сдохла часть прокладок, ставим в известность админов и меня.
- под крипт нужно выдавать и .dll, и .exe. Для крипта лучше .dll, но его не проверить в динамике.
.exe служит и для контрольной проверки на АВ, и на случай проблем с криптованием .dll.
- по возможности делать несколько версий файлов с разными хэш-суммами.

2. Разработчик должен самостоятельно проверить на автотестах утреннюю сборку, дать заключение о её пригодности не позднее чем 11 утра по Мск.
3. Пригодная сборка должна уйти в крипт не позже 12 часов дня.
4. Тестировщик должен узнать у клиента и подготовить для проверки список рабочих имен файлов (под которыми файл будет использоваться),
т.к. на имя может быть АВ детект.
Тестировщик оповещает о списке имен разработчика и криптера, чтобы те проводили свои тесты с использованием этих имен.
4.1. Если оказывается, что на все имена из списка есть АВ детекты, об этом оповещаются все (клиент, разработчик, криптер).
Пока готовится запасной список имен, используются простые ничего не говорящие "временные" имена. Например 1.exe, hello.exe, a.exe итд.
Если подготовка срочная (для кампании), файл так и выдается, с примечанием о важности имени.
5. Криптов каждого билда должно быть подготовлено минимум два. Лучше несколько. С разными хэш-суммами.
6. Не позже 14 часов крипт должен быть готов и передан на тестирование.
6.1. Криптер обязан самостоятельно проверить свой крипт на топовые АВ, в том числе средствами криптопанели.
Крипт с количеством детектов в рантайме > 3 принимается только в экстренных случаях.
В нормальном случае детектов в рантайме на корпоративные АВ быть не должно.
7. Для тестирования, тестировщик:
- подписывает крипт цифровой подписью (если есть)
- заливает файлы в админку, в разделе Groups -> (имя группы), проставляя новый номер версии
- помечает залитые файлы как Staging
- запускает на автотесты
8. При успешном прохождении тестов, тестировщик помечает в разделе Groups -> (имя группы) протестированный комплект файлов как Actual
9. Окончательная проверка подразумевает 
- переименование файла в рабочее имя
- заливку файла на сайт
- скачивание его через броузер
- запуск.
Т.к. именно таким является сценарий запуска файла пользователем.
На этой стадии, детект может появиться
- на имя файла
- может не пропустить smartscreen ОС.
10. В случае расхождения результата тестов на АВ - внутреннего и у заказчика, проверять следующие моменты:
- работоспособность автотеста и антивируса на соотв. ВМ (проверяется вручную)
- имя файла
- включена ли облачная защита АВ
- прочие настройки АВ
- версия АВ и базы

11. ВЫДАВАЕМЫЙ КЛИЕНТУ КРИПТ ДОЛЖЕН БЫТЬ ПОКРЫТ ПРУФАМИ:
В папке с криптом должны быть следующие отчеты (только если конкретный тест применялся):
11.1. Подкаталог auto с текстовыми логами автотестов с наших ВМ (копипаста логов)
11.2. Подканалог manual со снимками экрана каждой стадии ручного тестирования:
- окно "О системе" с информацией об ОС
- броузер с вводом ссылки для закачивания
- броузер и окно журнала АВ после закачивания
- окно журнала АВ сразу после запуска файла
- окно журнала АВ через интервал времени
- то же самое, для повторной закачки
- то же самое, при перезагрузке
11.3. Файл dyncheck.txt со ссылками на тестирование на dyncheck
Настройки тестирования на dyncheck:
- время теста - максимальное (240 сек)
- интернет - full access

В случае если крипт возвращается на перечистку, полный отчет не нужен, достаточно отчета, непосредственно отражающего детект.

12. Тестировщик должен еженедельно проверять на dyncheck снятые с работы билды.
Это нужно, чтобы своевременно выявить детекты на отсутствующих у нас антивирусах.
Параметры тестирования:
- статика, лоадер и бот x64
- динамика, только лоадер x64.
Проверку с включенным на тесте интернетом можно делать только утром, когда отстуки из песочниц не помешают боевой работе операторов.
В остальное время проверку на динамике делать только с выключенным на тесте интернетом!


*** ЧаВо ***
В: Каков должен быть комплект, выдаваемый в крипт?
О:
Полный:
лоадер 32 exe
лоадер 32 dll
лоадер 64 exe
лоадер 64 dll
бот 32 exe
бот 32 dll
бот 64 exe
бот 64 dll

Сокращенный: только 64-битные файлы из полного комплекта

В: Зачем готовить и .dll и .exe?
О: Криптер использует тот из файлов, который ему удобнее.
Обычно для криптования удобней .dll, но иногда - .exe
Кроме того, .exe является контрольным образцом - на случай, если что-то не заработало, можно запустить .exe и проверить работоспособность функционала.


В: Каков состав комплекта после крипта?
Полный:
лоадер 32 exe
лоадер 64 exe
бот 32 exe
бот 64 exe

Сокращенный: только 64-битные файлы из полного комплекта
